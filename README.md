# AWSStaticWebSiteStack
Cloud Formation Stack for Static Web Site on AWS

This Stack is used to create all resources needed to create a Static Web Site in AWS. After the execution it will create the folowing resources:
* S3 Bucket for Static Content;
* S3 Bucket for Logs;
* Cloudfront Distribution;
* Route53 alias for site;
* AWS Public Certificate.

For proper working you must provide the folowing resources:
* Hosted Zone configured in AWS Route53;
* S3 Bucket for Stack resources;

## Intermediate Resources
During stack creation a few intermediate resources are needed, mainly to automate the certificate approval process. At this moment, three lambda funcionts will be created at your account to perform the certification validation.

## Usage
For stack creation, you'll need a environment with awscli and python3. Clone the repo in this environment and run the script generate.py with the following parameters:
* -p/--profile      (Optional) awscli profile name;
* -s/--stack        (Required) cloud formation stack name;
* -z/--HostedZoneId  (Required) Route53 Hosted Zone Id to be used as domain name.
* -r/--run          (Optional) Run the Create Stack Command (If false, it only upload the stack and lambdas to S3 and you can star the creation from console).

## AWS Costs
The creation of these AWS resources does not incurr costs. However you will incur the costs as soon as you start serving content from your just created site. For information about the costs, check [the official AWS link for Cloud Front Distribution Pricing] (https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/CloudFrontPricing.html)

## AWS Security and Roles
For the stack creation, you must use a IAM User with permissions to:
* Create/Delete IAM Service Roles;
* Create/Update/Delete S3 Buckets and Bucket Configurations (ACL, StaticWebSite, Logging);
* Create/Update/Delete Lambda Functions;
* Create/Update/Delete CodeCommit Repositories/Codepipeline Pipelines/CodeBuild projects;
* Create/Update/Delete Cloudwatch Events/Event Rules;
* Request/Delete Certificates (ACM);
* Create/Update/Delete Cloudfront Distributions.

For this, you can start the stack creation with a user with AdministratorAccess Policy or append the stackCreationPolicy in this repository to your user.

## Nexts Steps
1. Implement CORS options for Static Web Site;
2. Generate buildspec.yml with bucket name generated by stack
3. Implement stack creation on generate script;
4. Implement stack monitoring on generate script;
5. Automatic create Angular project and add remote CodeCommit repository to project.

## Bugs and Improvements
If you find a bug in the stack templates or in lambda functions, please open an issue in this github repo. It would be better if you create a new branch, fix the bug or implement the improvement and submit a pull request. ;-)